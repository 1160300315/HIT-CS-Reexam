# 贪心算法

[TOC]

---

**概念**

贪婪法通过一系列步骤来构造问题的解，每一步对目前构造的部分解做一个扩展，直到获得问题的完整解。所作的每一步选择都要满足三个条件：
- 可行：必须满足问题的约束；
- 局部最优：是当前步骤中最佳的局部选择；
- 不可取消：后面的步骤中这个选择不能改变。

**它贪婪地选择最佳操作，并希望通过一系列局部的最优选择，能够产生一个整个问题的最优解。**

贪婪算法通常看上去简单直观，难的是对正确性的证明。

## 最优装载问题

**问题**：n 个集装箱1,2,...,n装上轮船，重量为 wi，载重限制为 C，如何能使装上船的 **集装箱最多**？（实际是 0-1 背包问题）

**建模**

设 <x1,...,xn> 为解向量，xi 表示装上第 i 个集装箱。

目标函数：$$\max \sum _{i=1}^{n} x_i$$

约束条件：$$\sum_{i=1}^{n}w_i x_i \leq C, x_i=0,1$$.

**算法设计**

贪心策略：轻的优先。将集装箱按重量排序，从轻的开始装，直到装不下。

**正确性证明（关键）**——使用归纳法

归纳基础：证明对任何只含一个箱子的输入实例，贪心法得到最优解。而这一点显然正确。

归纳步骤：假设对于任何 **n** 个箱子的输入实例贪心法都能得到最优解，那么对于任何 **n+1** 个箱子的输入实例贪心法也能得到最优解。

证明思路：原始输入为N={1,...,n+1} 共 n+1 个箱子(已排序)→去掉箱子 1，得到 C'=C-w1, N'={2,...,n+1}→由假设 N' 和 C' 的最优解为 I' → 在 I' 中加入箱子 1，得到 I → 证明 I 是最优解。

证明：

假设对于 n 个输入，贪心法可以得到最优解，则对于 N' 和 C' 的最优解记为 I'。

令 I=I'∪{1}，则 I 是关于 N 的最优解。

(反证)若不然，则存在最优解 I*，且 I*>I。那么 I*-{1} 是 N' 和 C' 的最优解，且 |I*-{1}|>|I-{1}|=|I'|，与 I' 是 N' 和 C' 的最优解矛盾。

---
## 求最小生成树——Prim 算法 & Kruskal 算法

### Prim 算法

**设计思想**：

输入：G=(V,E,W)

初始：S={1}

过程：**选择连接 S 和 V-S 集合的最短边 e**，将该条边加入结果集合 T，将该条边不属于 S 的端点加入 S。不断执行上述选边过程，直到 S=V。

**正确性证明**：

欲证命题：对于任意 k<n，存在一棵最小生成树包含算法 **前 k 步选择的边**。

归纳基础：在一棵最小生成树 T 中包含 **关联结点 1 的最小权的边** e={1,i}。

归纳步骤：假设前 k 步选择的边构成一棵最小生成树的边，则算法前 k+1 步选择的边也构成一棵最小生成树的边。

【证明归纳基础】：

**设 T 不包含 {1,i}，则 T∪{1,i} 含有一条回路**，回路中关联 1 的另一条边为 {1,j}，用 {1,i} 替换之得到树 T'，则 T' 的权值小于 T 的。（第一步挑的是连接结点 1 的最小权的边{1,i}）。

【归纳】：

1. 假设算法进行了 k 步，选出了 e1,...,ek 这些边，其端点集合为 S。假设最小生成树 T 包含这些边。
2. 算法下一步选择顶点 $$i_{k+1}$$，边 $$e_{k+1}=\{i_{k+1},i_l\}$$.
   1. 如果这条边属于 T，则显然算法第 k+1 步正确。
   2. 如果这条边不属于 T，则将其加入 T 后形成回路，回路中另一条连接 S 和 V-S 的边设为 e。令 T\* 为用该条边替换 e 之后形成的树。则 T\* 的权值小于 T 的。（算法选择的是连接两个集合的最小边）所以 **第 k+1 步得到的仍然是最小生成树**。

**时间复杂度**：$$O(n^2)$$.

### Kruskal 算法

**设计思想：**

1. 按照长度对边排序；
2. 一次考察当前最短边 e，如果 e 与 T 不构成回路，则把 e 加入 T，否则跳过 e。直到选择了 n-1 条边为止。

**正确性证明**

欲证命题：对于任意 n，算法对 n 阶图找到一棵最小生成树。

归纳基础：证明在 n=2 时，算法正确。这是显然的。

归纳步骤：假设算法对于 n 阶图是正确的，那么对于任何 n+1 阶图也是正确的。

【证明】

对于任意 n+1 阶图 G **短接最短边 e**，得到 n 阶图 G'.假设算法得到 G' 的最小生成树 T'.

T=T'∪{e} 是关于 G 的最小生成树. 不然，则可设 G 的含 e 边的最小生成树为 T\*，W(T\*)<W(T).

在 T\* 中短接 e 得到 G' 的生成树 T\*-{e}，W(T\*-{e})=W(T\*)-w(e)<W(T)-w(e)=W(T').

**时间复杂度**：O(m logn).

**应用**：单链聚类。

---
小结：

贪心算法的应用：

- 最优装载问题；
- 最小生成树算法——Kruskal、Prim；
- 单源最短路径——Dijkstra 算法；
- 哈夫曼树、最优前缀码(哈夫曼编码)。